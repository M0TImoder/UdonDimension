# UdonDimension

ロボットの挙動を検証する三次元物理エンジン  

> [!IMPORTANT]  
> **気が向いたら**作ります。  
> 計画の段階からガクチカの規模感をとっくに飛び出してる気もしますけどね...  

## About

説明にもある通り、ロボットの挙動を検証する目的の三次元物理エンジンです。  
Fusionからの設計読み込み、Arduinoのシミュレーション、MoJoCoベースのよりリアルな物理演算を搭載する**予定**です。  
全国で頭を抱える予算不足のロボコン部の一助になれば幸いです。  

以下は現状の設計です。ただのメモなので読む価値はないです。  

## Note

以下は現段階で決まったUdonDimensionの構想です。  
いずれも構想の域を過ぎないため変更される可能性があります。  

### コア層

使用言語: Rust  

UdonDimentionの中枢を管理する堅牢なコア。元はC++が候補に挙がっていたが、安全性を考慮し取りやめ。  

主に以下の役割を果たす。  

- メインフレーム (各層の通信, メモリ・スレッド, I/Oの管理)  
- 各層の抽象化 (traitによるAPI定義, FIIラッパー)  
- シミュレーションループ (時間管理・同期・例外復旧)  
- ログ、設定管理、非同期タスク  
- プラグイン/拡張レイヤーのロードと安全隔離  

Pythonとの連携を視野に入れるため、`pyo3`を使用する可能性あり。  
C++との連携を視野に入れるため、`libloading` `bindgen` を使用する可能性あり。  

### 各層・外部API接続ドライバ  

使用言語: C / C++  

主に以下の役割を果たす。  

- MuJoCo(C API)の直接呼び出し (物理演算)  
- Arduinoコードのビルド・ロード (制御再現)  
- Fusion 360 APIや低レベルDLLとの連携  
- 一部の描画パイプライン  
- RustへのFFIインタフェースを提供  

全て`unsafe`に封じ込めた上で取り扱う。  
Rustが呼び出しとデータの受け渡しを完全に制御する。  

### 拡張・スクリプト・外部制御層

使用言語: Python  

主に以下の役割を果たす。 

- ユーザー拡張 (アクチュエータ, 制御ロジック, AI制御などの追加)
- Fusion 360のPython APIを介したモデルの抽出
- 可視化・解析ツールとの連携
- 研究用モジュールの記述・テスト

`Pyo3`でRust構造体をPythonクラス化する。  
常にサンドボックス化してから取り扱う。  

### 監視層

使用言語: TypeScript / JavaScript

主に以下の役割を果たす。  

- Webダッシュボード / 監視UI
- WebAssembly経由でRustコア層との通信
- データ可視化 / 操作パネル

需要がニッチなため実装の優先順位は低い。  

### 描画層

使用言語: GPU言語系(未定)

主に以下の役割を果たす。  

- カメラレンダリング
- LiDERのレイトレーシング処理
- GPUベースの物理演算(MoJoCoはCPUベースのため実装の可能性は希薄)

### UI層

使用言語: Tauri, React, Tailwind CSS + shadcn/ui, Rustバックエンド

主に以下の役割を果たす。  

- リッチで機能的かつ軽量なUIの作成
